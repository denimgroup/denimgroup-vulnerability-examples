from flask import Flask
from flask import Response

app = Flask(__name__)

@app.route('/')
def hello_world():
	return 'Flask Dockerized 2'

@app.route('/vulnerabilities/mime-sniffing/')
def mimesniffing_home():
	resp = Response("<a href='textnosniff'>Vulnerable</a><br /><a href='textsniff'>Not Vulnerable</a>")

	return resp

@app.route('/vulnerabilities/mime-sniffing/textsniff')
def mimesniffing_home1():
	resp = Response("alert('Hi from nosniff');")
	resp.headers['X-Content-Type-Options'] = 'nosniff'
	resp.headers['Content-Security-Policy'] = 'default-src \'self\''
	resp.headers['Content-Type'] = 'text/plain'

	return resp

@app.route('/vulnerabilities/mime-sniffing/textnosniff')
def mimesniffing_home2():
	resp = Response("alert('No nosniff');")
	resp.headers['Content-Type'] = 'text/plain'

	return(resp)

if __name__ == '__main__':
	app.run(host='0.0.0.0')
